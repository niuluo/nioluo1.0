function createTree(b,c,d){var a={name:"tree",div:b,ulElement:null,childNodes:[],backcolor:c,contextMenu:d,selectedNode:null,nodeCounter:0,contextMenuDiv:null,rendered:false,createNode:function(n,g,j,m,h,k,e,i,l){v_tree=this;node={id:"node_"+this.nodeCounter,callback:l,JsonData:e,text:n,icon:j,parent:m,expanded:g,childNodes:[],tag:h,contextMenu:k,elementLi:null,CategoryType:i,removeNode:function(){v_tree.removeNode(this)},toggleNode:function(o){v_tree.toggleNode(this)},expandNode:function(o){v_tree.expandNode(this)},expandSubtree:function(){v_tree.expandSubtree(this)},setText:function(o){v_tree.setText(this,o)},collapseNode:function(){v_tree.collapseNode(this)},collapseSubtree:function(){v_tree.collapseSubtree(this)},removeChildNodes:function(){v_tree.removeChildNodes(this)},createChildNode:function(t,r,p,o,u,s,q,v){return v_tree.createNode(t,r,p,this,o,u,s,q,v)}};this.nodeCounter++;if(this.rendered){if(m==undefined){this.drawNode(this.ulElement,node);this.adjustLines(this.ulElement,false)}else{var f=m.elementLi.getElementsByTagName("ul")[0];if(m.childNodes.length==0){if(m.expanded){m.elementLi.getElementsByTagName("ul")[0].style.display="block";v_img=m.elementLi.getElementsByTagName("img")[0];v_img.style.visibility="visible";v_img.src="../Images/Custom/collapse.png";v_img.id="toggle_off"}else{m.elementLi.getElementsByTagName("ul")[0].style.display="none";v_img=m.elementLi.getElementsByTagName("img")[0];v_img.style.visibility="visible";v_img.src="../Images/Custom/expand.png";v_img.id="toggle_on"}}this.drawNode(f,node);this.adjustLines(f,false)}}if(m==undefined){this.childNodes.push(node);node.parent=this}else{m.childNodes.push(node)}return node},drawTree:function(){this.rendered=true;var f=document.getElementById(this.div);f.innerHTML="";ulElement=createSimpleElement("ul",this.name,"tree");this.ulElement=ulElement;for(var e=0;e<this.childNodes.length;e++){this.drawNode(ulElement,this.childNodes[e])}f.appendChild(ulElement);this.adjustLines(document.getElementById(this.name),true)},drawNode:function(e,j){v_tree=this;var m=null;if(j.icon!=null){m=createIconElement(null,j.icon)}var g=document.createElement("li");j.elementLi=g;var l=createSimpleElement("span",null,"node");var f=null;if(j.childNodes.length==0){f=createImgElement("toggle_off","exp_col","../Images/Custom/collapse.png");f.style.visibility="hidden"}else{if(j.expanded){f=createImgElement("toggle_off","exp_col","../Images/Custom/collapse.png")}else{f=createImgElement("toggle_on","exp_col","../Images/Custom/expand.png")}}l.ondblclick=function(){v_tree.doubleClickNode(j)};f.onclick=function(){v_tree.toggleNode(j)};l.onclick=function(){v_tree.selectNode(j)};l.oncontextmenu=function(i){v_tree.selectNode(j);v_tree.nodeContextMenu(i,j)};if(m!=undefined){l.appendChild(m)}v_a=createSimpleElement("a",null,null);v_a.innerHTML=j.text;l.appendChild(v_a);g.appendChild(f);g.appendChild(l);e.appendChild(g);var k=createSimpleElement("ul","ul_"+j.id,null);g.appendChild(k);if(j.childNodes.length>0){if(!j.expanded){k.style.display="none"}for(var h=0;h<j.childNodes.length;h++){this.drawNode(k,j.childNodes[h])}}},setText:function(e,f){e.elementLi.getElementsByTagName("span")[0].lastChild.innerHTML=f;e.text=f},expandTree:function(){for(var e=0;e<this.childNodes.length;e++){if(this.childNodes[e].childNodes.length>0){this.expandSubtree(this.childNodes[e])}}},expandSubtree:function(f){this.expandNode(f);for(var e=0;e<f.childNodes.length;e++){if(f.childNodes[e].childNodes.length>0){this.expandSubtree(f.childNodes[e])}}},collapseTree:function(){for(var e=0;e<this.childNodes.length;e++){if(this.childNodes[e].childNodes.length>0){this.collapseSubtree(this.childNodes[e])}}},collapseSubtree:function(f){this.collapseNode(f);for(var e=0;e<f.childNodes.length;e++){if(f.childNodes[e].childNodes.length>0){this.collapseSubtree(f.childNodes[e])}}},expandNode:function(f){if(f.childNodes.length>0&&f.expanded==false){if(this.nodeBeforeOpenEvent!=undefined){this.nodeBeforeOpenEvent(f)}var e=f.elementLi.getElementsByTagName("img")[0];f.expanded=true;e.id="toggle_off";e.src="../Images/Custom/collapse.png";elem_ul=e.parentElement.getElementsByTagName("ul")[0];elem_ul.style.display="block";if(this.nodeAfterOpenEvent!=undefined){this.nodeAfterOpenEvent(f)}}},collapseNode:function(f){if(f.childNodes.length>0&&f.expanded==true){var e=f.elementLi.getElementsByTagName("img")[0];f.expanded=false;if(this.nodeBeforeCloseEvent!=undefined){this.nodeBeforeCloseEvent(f)}e.id="toggle_on";e.src="../Images/Custom/expand.png";elem_ul=e.parentElement.getElementsByTagName("ul")[0];elem_ul.style.display="none"}},toggleNode:function(e){if(e.childNodes.length>0){if(e.expanded){e.collapseNode()}else{e.expandNode()}}},doubleClickNode:function(e){this.toggleNode(e)},selectNode:function(e){var f=e.elementLi.getElementsByTagName("span")[0];f.className="node_selected";if(this.selectedNode!=null&&this.selectedNode!=e){this.selectedNode.elementLi.getElementsByTagName("span")[0].className="node"}this.selectedNode=e;if(e.callback!=undefined&&typeof(e.callback)=="function"){e.callback(e.JsonData,e)}},removeNode:function(f){var e=f.parent.childNodes.indexOf(f);if(f.elementLi.className=="last"&&e!=0){f.parent.childNodes[e-1].elementLi.className+="last"}f.elementLi.parentNode.removeChild(f.elementLi);f.parent.childNodes.splice(e,1);if(f.parent.childNodes.length==0){var g=f.parent.elementLi.getElementsByTagName("img")[0];g.style.visibility="hidden"}},removeChildNodes:function(e){if(e.childNodes.length>0){var g=e.elementLi.getElementsByTagName("ul")[0];var f=e.elementLi.getElementsByTagName("img")[0];f.style.visibility="hidden";e.childNodes=[];g.innerHTML=""}},nodeContextMenu:function(l,k){if(l.button==2){l.preventDefault();l.stopPropagation();if(k.contextMenu!=undefined){v_tree=this;var f=this.contextMenu[k.contextMenu];var j;if(this.contextMenuDiv==null){j=createSimpleElement("ul","ul_cm","tree_menu");document.body.appendChild(j)}else{j=this.contextMenuDiv}j.innerHTML="";var e=l.pageX-5;var g=l.pageY-5;j.style.display="block";j.style.position="absolute";j.style.left=e+"px";j.style.top=g+"px";for(var h=0;h<f.elements.length;h++){(function(o){var n=createSimpleElement("li",null,null);var s=createSimpleElement("span",null,null);s.onclick=function(){f.elements[o].action(k)};var p=createSimpleElement("a",null,null);var r=createSimpleElement("ul",null,"tree-sub-menu");p.appendChild(document.createTextNode(f.elements[o].text));n.appendChild(s);if(f.elements[o].icon!=undefined){var q=createIconElement("null",f.elements[o].icon);n.appendChild(q)}n.appendChild(p);n.appendChild(r);j.appendChild(n);if(f.elements[o].submenu!=undefined){var m=createSimpleElement("div",null,null);m.appendChild(createImgElement(null,"menu_img","images/right.png"));n.appendChild(m);v_tree.contextMenuLi(f.elements[o].submenu,r,k)}})(h)}this.contextMenuDiv=j}}},contextMenuLi:function(e,f,h){v_tree=this;for(var g=0;g<e.elements.length;g++){(function(l){var k=createSimpleElement("li",null,null);var p=createSimpleElement("span",null,null);p.onclick=function(){e.elements[l].action(h)};var m=createSimpleElement("a",null,null);var o=createSimpleElement("ul",null,"tree-sub-menu");m.appendChild(document.createTextNode(e.elements[l].text));k.appendChild(p);if(e.elements[l].icon!=undefined){var n=createIconElement("null",e.elements[l].icon);k.appendChild(n)}k.appendChild(m);k.appendChild(o);f.appendChild(k);if(e.elements[l].p_submenu!=undefined){var j=createSimpleElement("div",null,null);j.appendChild(createImgElement(null,"menu_img","images/right.png"));k.appendChild(j);v_tree.contextMenuLi(e.elements[l].p_submenu,o,h)}})(g)}},adjustLines:function(h,g){var f=h;var e=[];if(f.childNodes.length>0){e=[f];if(g){for(var j=0;j<f.getElementsByTagName("ul").length;j++){var l=f.getElementsByTagName("ul")[j];if(l.childNodes.length!=0){e[e.length]=l}}}}for(var j=0;j<e.length;j++){var k=e[j].lastChild;while(!k.tagName||k.tagName.toLowerCase()!="li"){k=k.previousSibling}k.className+="last";k=k.previousSibling;if(k!=null){if(k.tagName.toLowerCase()=="li"){k.className="";k.style.backgroundColor="transparent"}}}}};window.onclick=function(){if(a.contextMenuDiv!=null){a.contextMenuDiv.style.display="none"}};return a}function createSimpleElement(a,b,c){element=document.createElement(a);if(b!=undefined){element.id=b}if(c!=undefined){element.className=c}return element}function createImgElement(b,c,a){element=document.createElement("img");if(b!=undefined){element.id=b}if(c!=undefined){element.className=c}if(a!=undefined){element.src=a}return element}function createIconElement(a,b){element=document.createElement("ol");if(a!=undefined){element.id=a}if(b!=undefined){element.className=b}return element};