var visitDetailModule=angular.module("VisitDetailModule",["ResourceModule","HttpModule"]);visitDetailModule.service("VisitService",["ManagementHttpService","ResourceFactory",function(c,b){var a={};a.tipMsg=function(){$("#toast").fadeIn(100);setTimeout(function(){$("#toast").fadeOut(100)},1500)};a.getVisitDetail=function(){return b.getDataFromSession("CurrentVisit")};a.saveFeedback=function(d){var f=d.currentVisit;try{c.weVisitRequest(f,b.operateCode.update,function(e){if(e.Header.StatusCode==0){d.isShow=false;a.tipMsg()}else{alert("更新失败，请稍后重试！");console.log(e)}},function(e){alert("服务器繁忙，请稍后重试！");console.log(e)})}catch(g){console.log(g)}};return a}]);visitDetailModule.controller("VisitDetailController",["$scope","VisitService",function(a,b){a.initialize=function(){a.currentVisit=b.getVisitDetail();a.isShow=true;if(a.currentVisit.Feedback){a.feedback=a.currentVisit.Feedback;a.isShow=false}};a.saveFeedback=function(){if(a.feedback){a.currentVisit.Feedback=a.feedback;b.saveFeedback(a)}};a.initialize()}]);angular.bootstrap($("#visit_detail"),["VisitDetailModule"]);