var visitModule=angular.module("VisitModule",["ResourceModule","HttpModule"]);visitModule.service("VisitService",["ManagementHttpService","ResourceFactory",function(c,b){var a={};a.initialize=function(){};a.getPatientInfo=function(d){var e=d.requestData;c.wePatientRequest(e,b.operateCode.get,function(f){if(f.Header.StatusCode==0){b.saveDataToSession("CurrentPatient",f.Body);d.currentPatient=f.Body;a.getVisitList(d)}else{alert(b.getErrorMsg(f.Header.StatusCode))}},function(f){console.log(f)})};a.getVisitList=function(d){var f={PatientID:d.currentPatient.PatientID};try{c.weVisitRequest(f,b.operateCode.get,function(e){if(e.Header.StatusCode==0){d.visitList=e.Body}else{alert("获取回访列表失败，请稍后重试！");console.log(e)}},function(e){alert("服务器繁忙，请稍候重试！");console.log(e)})}catch(g){console.log(g)}};return a}]);visitModule.controller("VisitController",["$scope","VisitService","ResourceService","ResourceFactory",function(b,d,c,a){b.initialize=function(){b.requestData={Code:c.getURLData()};b.currentPatient=a.getDataFromSession("CurrentPatient");if(!b.currentPatient){d.getPatientInfo(b)}else{d.getVisitList(b)}};b.showDetail=function(e){a.saveDataToSession("CurrentVisit",e);window.location.href="DCVisitDetail.html"};b.convertVisitTime=function(e){return new Date(e)};b.initialize()}]);angular.bootstrap($("#visit_list"),["VisitModule"]);