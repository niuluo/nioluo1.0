var medicalRecordModule=angular.module("MedicalRecordModule",["ResourceModule","HttpModule"]);medicalRecordModule.service("MedicalRecordService",["ResourceFactory","ManagementHttpService",function(b,c){var a={};a.initialize=function(){};a.getPatientInfo=function(d){var e=d.requestData;c.wePatientRequest(e,b.operateCode.get,function(f){if(f.Header.StatusCode==0){b.saveDataToSession("CurrentPatient",f.Body);d.currentPatient=f.Body;a.searchMedicalRecord(d)}else{alert(b.getErrorMsg(f.Header.StatusCode))}},function(f){console.log(f)})};a.searchMedicalRecord=function(d){var f={PatientID:d.currentPatient.PatientID};try{c.weTreatsRequest(f,b.operateCode.get,function(e){if(e.Header.StatusCode==0){d.treats=e.Body}else{alert("获取病例列表失败，请稍后重试");console.log(e)}},function(e){alert("服务器繁忙，请稍候重试！");console.log(e)})}catch(g){console.log(g)}};return a}]);medicalRecordModule.controller("MedicalRecordController",["$scope","MedicalRecordService","ResourceService","ResourceFactory","$filter",function(b,c,e,a,d){b.initialize=function(){b.requestData={Code:e.getURLData("code")};b.currentPatient=a.getDataFromSession("CurrentPatient");c.initialize();if(!b.currentPatient){c.getPatientInfo(b)}else{c.searchMedicalRecord(b)}};b.calculateAge=function(f){return e.calculateAge(new Date(f).Format("yyyy-MM-dd"))};b.getGenderName=function(f){switch(f){case 1:return"男";case 2:return"女";default:return"无"}};b.searchMedicalRecord=function(){c.searchMedicalRecord()};b.showDetail=function(f){a.saveDataToSession("CurrentMedicalRecord",f);window.location.href="DCMedicalRecordDetail.html"};b.getAppointTime=function(f){return new Date(f)};b.initialize()}]);angular.bootstrap($("#medical_record"),["MedicalRecordModule"]);