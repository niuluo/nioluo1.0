var accountDetailModule = angular.module("AccountDetailModule", ["ResourceModule", "HttpModule"]);

accountDetailModule.service("AccountDetailService", ["ResourceFactory", "ManagementHttpService", function (ResourceFactory, ManagementHttpService) {
    var service = {};

    //初始化环境
    service.initialize = function ($scope) {
        $scope.currentPatient = ResourceFactory.getDataFromSession("CurrentPatient");
        $scope.currentAccount = ResourceFactory.getDataFromSession("CurrentAccount");
    };

    service.goToRefund = function (item) {
        window.location.href = "Refund.html";
    };

    return service;
}]);

accountDetailModule.controller("AccountDetailController", ["$scope", "AccountDetailService", function ($scope, AccountDetailService) {
    //初始化环境
    $scope.initialize = function () {
        AccountDetailService.initialize($scope);
    };

    $scope.goToRefund = function () {
        AccountDetailService.goToRefund();
    };

    $scope.statusText = function (status) {
        if (status == 0 || status == 1) {
            return "待支付";
        } else if (status == 4) {
            return "已支付";
        } else if (status == 2) {
            return "欠费";
        } else if (status == 3) {
            return "已完成";
        } else if (status == 5) {
            return "申退中";
        } else {
            return "未知";
        }
    };

    $scope.showName = function (cost) {
        if (!cost) {
            return "";
        }

        if (cost.CostItem) {
            return cost.CostItem;
        }

        if (cost.SubCategoryName) {
            return cost.SubCategoryName;
        }

        if (cost.CategoryName) {
            return cost.CategoryName;
        }

        return "";
    };

    $scope.categoryText = function (category) {
        if (category == 1) {
            return "现金";
        } else if (category == 2) {
            return "银行卡";
        } else if (category == 3) {
            return "微信";
        } else if (category == 4) {
            return "支付宝";
        } else if (category == 5) {
            return "社保卡";
        } else if (category == 6) {
            return "会员卡";
        } else if (category == 7) {
            return "余额";
        } else if (category == 8) {
            return "其他";
        } else if (category == 9) {
            return "账单退款";
        } else {
            return "未知";
        }
    };

    $scope.initialize();
}]);

angular.bootstrap($("#account_detail"), ["AccountDetailModule"]);